#!/bin/bash
#   exit variables  #
OK=0
WARNING=1
CRITICAL=2
UNKNOWN=3

probe=`fping \
172.26.117.10 \
172.26.117.11 \
172.26.117.12 \
172.26.117.13 \
172.26.117.14 \
172.26.117.15 \
172.26.117.16 \
172.26.117.17 \
172.26.117.18 \
172.26.117.19 \
172.26.117.20 \
172.26.117.21 \
172.26.117.22 \
172.26.117.23 \
172.26.117.24 \
172.26.117.25 \
172.26.117.26 \
172.26.117.27 \
172.26.117.28 \
172.26.117.29 \
172.26.117.30 \
172.26.117.31 \
172.26.117.32 \
172.26.117.33 \
172.26.117.34 \
172.26.117.35 \
172.26.117.36 \
172.26.117.37 \
172.26.117.38 \
172.26.117.39 \
172.26.117.40 \
172.26.117.41 \
172.26.117.42 \
172.26.117.43 \
172.26.117.44 \
172.26.117.45 \
172.26.117.46 \
172.26.117.47 \
172.26.117.48 \
172.26.117.49 \
172.26.117.50 \
172.26.117.51 \
172.26.117.52 \
172.26.117.53 \
172.26.117.54 \
172.26.117.55 \
| grep "is unreachable" | grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}'`

if [ -z "$probe" ]
then
    echo "All Cams are online"
    exit $OK
else
    Offline=$(echo "$probe" | (wc -l))
    Offline=$((Offline-1))
    echo "${probe} and ${Offline} more are unreachable"
    exit $CRITICAL
fi
